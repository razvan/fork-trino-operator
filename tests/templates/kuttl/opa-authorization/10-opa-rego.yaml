---
apiVersion: kuttl.dev/v1beta1
kind: TestStep
commands:
  - script: |
      # Trino Rego rules provided by the Stackable Data Platform
      kubectl create configmap trino-opa-rules \
        --namespace=$NAMESPACE \
        --from-file=rego/trino.rego
      kubectl label configmaps trino-opa-rules \
        opa.stackable.tech/bundle=trino \
        --namespace=$NAMESPACE

      # Trino policies provided by the customer
      kubectl create configmap trino-opa-policies \
        --namespace=$NAMESPACE \
        --from-file=rego/policies.rego
      kubectl label configmaps trino-opa-policies \
        opa.stackable.tech/bundle=trino \
        --namespace=$NAMESPACE
